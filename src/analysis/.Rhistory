geom_point() +
ylab("Rings") +
xlab("Shell weight") +
geom_line(aes(group = Shell_weight, color = "error")) +
labs(color = "Data type") +
facet_wrap(~ method, ncol = 1)
myData1$Rings = myResult
myData1 = cbind(myData1, data.type = "prediction", method = "lm")
myData1 = rbind(myData1, cbind(myTest, data.type = "original value", method = "lm"))
myData1 = melt.data.frame(
data = myData1,
id.vars = c("Shell_weight", "data.type", "method"),
measure.vars = "Rings",
rm.na = F
)
ggplot(myData1, aes(x = Shell_weight, y = value, color = data.type)) +
geom_point() +
ylab("Rings") +
xlab("Shell weight") +
geom_line(aes(group = Shell_weight, color = "error")) +
labs(color = "Data type") +
facet_wrap(~ method, ncol = 1)
myData1 = myTest
myData1$Rings = myResult
myData1 = cbind(myData1, data.type = "prediction", method = "lm")
myData1 = rbind(myData1, cbind(myTest, data.type = "original value", method = "lm"))
myData1 = melt.data.frame(
data = myData1,
id.vars = c("Shell_weight", "data.type", "method"),
measure.vars = "Rings",
rm.na = F
)
ggplot(myData1, aes(x = Shell_weight, y = value, color = data.type)) +
geom_point() +
ylab("Rings") +
xlab("Shell weight") +
geom_line(aes(group = Shell_weight, color = "error")) +
labs(color = "Data type") +
facet_wrap(~ method, ncol = 1)
source('/home/cristian10/workspace/master/icd/final/src/regression/comparison.R', echo=TRUE)
source('/home/cristian10/workspace/master/icd/final/src/regression/comparison.R', echo=TRUE)
ggplot(myData, aes(x = Shell_weight, y = value, color = data.type)) +
geom_point() +
ylab("Rings") +
xlab("Shell weight") +
geom_line(aes(group = Shell_weight, color = "error")) +
labs(color = "Data type")
ggplot(myData, aes(x = Shell_weight, y = value, color = data.type)) +
geom_point() +
ylab("Rings") +
xlab("Shell weight") +
geom_line(aes(group = Shell_weight, color = "error")) +
labs(color = "Data type") +
facet_wrap( ~ model, ncol = 1)
View(myData)
ggplot(myData1, aes(x = Shell_weight, y = value, color = data.type)) +
geom_point() +
ylab("Rings") +
xlab("Shell weight") +
geom_line(aes(group = Shell_weight, color = "error")) +
labs(color = "Data type") +
facet_wrap( ~ model, ncol = 1)
ggplot(myData1, aes(x = Shell_weight, y = value, color = data.type)) +
geom_point() +
ylab("Rings") +
xlab("Shell weight") +
geom_line(aes(group = Shell_weight, color = "error")) +
labs(color = "Data type") +
facet_wrap( ~ method, ncol = 1)
ggplot(myData, aes(x = Shell_weight, y = value, color = data.type)) +
geom_point() +
ylab("Rings") +
xlab("Shell weight") +
geom_line(aes(group = Shell_weight, color = "error")) +
labs(color = "Data type") +
facet_wrap( ~ method, ncol = 1)
myTest = abalone.tst[[1]]
lmErrors  = predict(myFit, myTest)
knnErrors = kknn(myModel,  myTrain, myTest, k = 7)$fitted.values
myTest = abalone.tst[[1]]
lmErrors  = myTest$Rings-predict(myFit, myTest)
knnErrors = kknn(myModel,  myTrain, myTest, k = 7)$fitted.values
knnErrors = myTest$Rings-kknn(myModel,  myTrain, myTest, k = 7)$fitted.values
myTest = abalone.tst[[1]]
lmErrors  = myTest$Rings-predict(myFit, myTest)
knnErrors = myTest$Rings-kknn(myModel,  myTrain, myTest, k = 7)$fitted.values
myData1 = data.frame(method = "Linear Model", SqErr = lmErrors^2)
myData2 = data.frame(method = "k-NN", SqErr = knnErrors^2)
myData = melt.data.frame(
data = rbind(myData1, myData2),
id.vars = "method"
)
ggplot(myData) + geom_density()
ggplot(myData) + geom_density(aes(x=SqErr))
ggplot(myData) + geom_density(aes(x=value))
ggplot(myData) + geom_density(aes(x=value, color = method))
myTest = abalone.tst[[1]]
lmErrors  = myTest$Rings-predict(myFit, myTest)
knnErrors = myTest$Rings-kknn(myModel,  myTrain, myTest, k = 7)$fitted.values
myData1 = data.frame(method = "Linear Model", SqErr = lmErrors)
myData2 = data.frame(method = "k-NN", SqErr = knnErrors)
myData = melt.data.frame(
data = rbind(myData1, myData2),
id.vars = "method"
)
ggplot(myData) + geom_density(aes(x=value, color = method))
ggplot(myData) + geom_density(aes(x=value, fill = method))
ggplot(myData) + geom_density(aes(x=value, fill = method, alpha = 0.3))
ggplot(myData) + geom_density(aes(x=value, fill = method), alpha = 0.3)
ggplot(myData, aes(x=value)) +
geom_density(aes(color = method, fill = method), alpha = 0.3)
ggplot(myData, aes(x=value)) +
geom_density(aes(color = method, fill = method), alpha = 0.3) +
xlab("Error")
myData1 = data.frame(method = "Linear Model", Err = lmErrors)
myData2 = data.frame(method = "k-NN", Err = knnErrors)
myData = melt.data.frame(
data = rbind(myData1, myData2),
id.vars = "method"
)
ggplot(myData, aes(x=value)) +
geom_density(aes(color = method, fill = method), alpha = 0.3) +
xlab("Error")
testResults = read.csv("../regression/regr_test_alumnos.csv")
dim(testResults)
ncol(testResults)
testTable = cbind(testResults[, 2:ncol(testResults)])
testTable
testResults
testTable = testResults[, 2:ncol(testResults)]
testResults[, 2:ncol(testResults)] == cbind(testResults[,2:dim(testResults)[2]])
testResults = read.csv("../regression/regr_test_alumnos.csv")
testTable = testResults[, 2:ncol(testResults)]
rownames(testTable) = testResults[,1]
View(testTable)
trainResults = read.csv("../regression/regr_train_alumnos.csv")
trainTable = trainResults[, 2:ncol(testResults)]
rownames(trainTable) = trainResults[,1]
View(trainTable)
difs = (testTable[,1] - testTable[,2])/testTable[,1]
View(testTable)
wilc_1_2 = cbind(
ifelse((difs<0, abs(difs)+0.1), 0.1),
ifelse((difs>0, abs(difs)+0.1), 0.1)
wilc_1_2 = cbind(
ifelse(difs<0, abs(difs)+0.1, 0.1),
ifelse(difs>0, abs(difs)+0.1, 0.1)
)
View(wilc_1_2)
colnames(wilc_1_2) = colnames(testTable)[1:2]
View(wilc_1_2)
LMvsKNNtst = wilcox.test(wilc_1_2[,1], wilc_1_2[,2], alternative = "two.sided", paired = TRUE)
Rplus = LMvsKNNtst$statistic
pvalue = LMvsKNNtst$pvalue
WilcoxonTestOutput = cbind(Rmas, Rmenos, pvalue)
Rminus = LMvsKNNtst$statistic
WilcoxonTestOutput = cbind(Rplus, Rminus, pvalue)
View(WilcoxonTestOutput)
WilcoxonTestOutput = cbind(Rplus, Rminus, pvalue)
View(WilcoxonTestOutput)
View(WilcoxonTestOutput)
WilcoxonTestOutput
pvalue
pvalue = LMvsKNNtst$pvalue
WilcoxonTestOutput = cbind(Rplus, Rminus, pvalue)
pvalue
pvalue = LMvsKNNtst$p.value
WilcoxonTestOutput = cbind(Rplus, Rminus, pvalue)
FriedmanTest = friedman.test(as.matrix(testTable))
FriedmanTest
FriedmanTest$statistic
FriedmanTest$method
wilc_1_2 = cbind(
ifelse(difs<0, abs(difs)+0.1, 0.1),
ifelse(difs>0, abs(difs)+0.1, 0.1)
)
View(wilc_1_2)
LMvsKNNtst = wilcox.test(
wilc_1_2[,1],
wilc_1_2[,2],
alternative = "two.sided",
paired = TRUE
)
Rplus  = LMvsKNNtst$statistic
pvalue = LMvsKNNtst$p.value
LMvsKNNtst = wilcox.test(
wilc_1_2[,2],
wilc_1_2[,1],
alternative = "two.sided",
paired = TRUE
)
Rminus = LMvsKNNtst$statistic
WilcoxonTestOutput = cbind(Rplus, Rminus, pvalue)
View(WilcoxonTestOutput)
## Comparison amongst LM, kNN and M5'
FriedmanTest = friedman.test(as.matrix(testTable))
FriedmanTest
testTable
FriedmanTest = friedman.test(as.matrix(trainTable))
FriedmanTest
FriedmanTest = friedman.test(as.matrix(testTable))
FriedmanTest
groups = rep(1:ncol(testTable), each = nrow(testTable))
groups
pairwise.wilcox.test(as.matrix(testTable), groups, p.adjust.method = "holm", paired = TRUE)
testTable
as.matrix(testTable)
source('/home/cristian10/workspace/master/icd/final/src/regression/comparison.R', echo=TRUE)
pairwise.wilcox.test(
as.matrix(trainTable),
groups,
p.adjust.method = "holm",
paired = TRUE
)
colnames(wilc_1_2) = colnames(testTable)[1:2]
difs = (testTable[,1] - testTable[,2])/testTable[,1]
wilcox.test(lmErrors, knnErrors, paired = TRUE)
wilcox.test(lmErrors, knnErrors, paired = FALSE)
ks.test(lmErrors, knnErrors)
wilcox.test(lmErrors, knnErrors, paired = FALSE)
wilcox.test(lmErrors^2, knnErrors^2, paired = FALSE)
wilcox.test(lmErrors^2, knnErrors^2, paired = TRUE)
ks.test(lmErrors^2, knnErrors^2)
ggplot(myData, aes(x=value^2)) +
geom_density(aes(color = method, fill = method), alpha = 0.3) +
xlab("Error")
ggplot(myData, aes(x=value^2)) +
geom_density(aes(color = method, fill = method), alpha = 0.3) +
xlab("Error") + xlim(0,50)
ggplot(myData, aes(x=value^2)) +
geom_density(aes(color = method, fill = method), alpha = 0.3) +
xlab("Error") + xlim(0,35)
ggplot(myData, aes(x=value^2)) +
geom_density(aes(color = method, fill = method), alpha = 0.3) +
xlab("Error") + xlim(0,20)
wilcox.test(lmErrors^2, knnErrors^2, paired = TRUE)
wilcox.test(lmErrors^2, knnErrors^2, paired = FALSE)
ks.test(lmErrors^2, knnErrors^2)
wilcox.test(lmErrors^2, knnErrors^2, paired = FALSE)
myData1 = data.frame(method = "Linear Model", Err = lmErrors)
myData2 = data.frame(method = "k-NN", Err = knnErrors)
myData = melt.data.frame(
data = rbind(myData1, myData2),
id.vars = "method"
)
# Build the workspace
source("../regression/build-workspace.R")
abalone.tra = lapply(abalone.tra, add.non.linearities)
abalone.tst = lapply(abalone.tst, add.non.linearities)
# Comparison of data points
myModel = Rings ~
Length +
Height +
Whole_weight.log *
Shucked_weight.log *
Viscera_weight *
Shell_weight.3
myTrain = abalone.tra[[1]]
myTest  = abalone.tst[[1]][sample(1:nrow(abalone.tst[[1]]), 20), ]
## Linear regression
# Plot some points of the last model
myFit = lm(myModel, myTrain)
myResult = predict(myFit, myTest)
myData1 = myTest
myData1$Rings = myResult
myData1 = cbind(myData1, data.type = "prediction", method = "Linear Model")
myData1 = rbind(myData1, cbind(myTest, data.type = "original value", method = "Linear Model"))
myData1 = melt.data.frame(
data = myData1,
id.vars = c("Shell_weight", "data.type", "method"),
measure.vars = "Rings"
)
## k-NN
# Plot some points of the last model
myResult = kknn(myModel, myTrain, myTest, k = 7)
myData2 = myTest
myData2$Rings = myResult$fitted.values
myData2 = cbind(myData2, data.type = "prediction", method = "k-NN")
myData2 = rbind(myData2, cbind(myTest, data.type = "original value", method = "k-NN"))
myData2 = melt.data.frame(
data = myData2,
id.vars = c("Shell_weight", "data.type", "method"),
measure.vars = "Rings"
)
## Plot
myData = rbind(myData1, myData2)
ggplot(myData, aes(x = Shell_weight, y = value, color = data.type)) +
geom_point() +
ylab("Rings") +
xlab("Shell weight") +
geom_line(aes(group = Shell_weight, color = "error")) +
labs(color = "Data type") +
facet_wrap( ~ method, ncol = 1)
geom_line(aes(group = Shell_weight, color = "error")) +
;
# Error distribution
myTest = abalone.tst[[1]]
lmErrors  = myTest$Rings-predict(myFit, myTest)
knnErrors = myTest$Rings-kknn(myModel, myTrain, myTest)$fitted.values
myData1 = data.frame(method = "Linear Model", Err = lmErrors)
myData2 = data.frame(method = "k-NN", Err = knnErrors)
myData = melt.data.frame(
data = rbind(myData1, myData2),
id.vars = "method"
)
### Tests
wilcox.test(lmErrors^2, knnErrors^2, paired = FALSE)
ks.test(lmErrors^2, knnErrors^2)
ggplot(myData, aes(x=value^2)) +
geom_density(aes(color = method, fill = method), alpha = 0.3) +
xlab("Error") + xlim(0,20)
ggplot(myData, aes(x=value^2)) +
geom_density(aes(color = method, fill = method), alpha = 0.3) +
xlab("Squared error") + xlim(0,20)
?wilcox.test
?pairwise.wilcox.test
FriedmanTest = friedman.test(as.matrix(testTable))
friedman.test(as.matrix(testTable))
WilcoxonTestOutput = cbind(Rplus, Rminus, pvalue)
a = c(1,2,3,4,5)
b = 10*a
a/var(a)
b/var(b)
b/sd(b)
a/sd(a)
mean(a)
mean(a/sd(a))
(a-min(a))/sd(a)
(a-2*min(a))/sd(a)
(a-min(a))/sd(a)-sd(a)/2
(a-min(a))/sd(a)-sd(a)
(a-min(a))/sd(a)
(b-min(b))/sd(b)
(a-mean(a))/sd(a)
median(a)
a = c(a,6)
median(a)
b = c(b,60)
source("../classification/build-workspace.R")
# Get the data type and dimension
class(tae)
dim(tae)
# Get the data types of every field
lapply(tae, class)
# Check if there are missing values
colSums(is.na(tae))
# Get the statistical measurements (numeric variables)
attach(tae)
min       (Size)        # Minimum
quantile  (Size, 0.25)  # 1st Quartile
median    (Size)        # Median
mean      (Size)        # Mean
quantile  (Size, 0.75)  # 3rd Quartile
max       (Size)        # Max
var       (Size)        # Variane
sd        (Size)        # Standard deviation
detach(tae)
# Get summarized information
str(tae)      # Structure
summary(tae)  # Statistical measurements
View(tae)
ggplot(tae, aes(x = Instructor, y = Size, color = Class)) +
geom_point()
ggplot(tae, aes(x = Course, y = Size, color = Class)) +
geom_point()
ggplot(tae, aes(x = Course, y = Instructor, color = Class)) +
geom_point()
myData = melt.data.frame(data = subset(tae, select = Instructor+Course+Size))
subset(tae)
subset(tae, select = Size)
subset(tae, select = Instructor+Size)
subset(tae, select = Instructor,Size)
?subset
myData = melt.data.frame(data = subset(tae, select = c(Instructor, Course, Size)))
myData = melt.data.frame(
data = subset(tae, select = c(Instructor, Course, Size, Class))
)
myData = melt.data.frame(
data = subset(tae, select = c(Instructor, Course, Size, Class)),
id.vars = "Class"
)
View(myData)
myData = melt.data.frame(
data = subset(tae, select = c(Instructor, Course, Size, Class)),
id.vars = "Class"
)
View(tae)
# Visualize numerical variables
myData = melt.data.frame(
data = subset(tae, select = c(Class, Instructor, Course, Size)),
id.vars = "Class"
)
str(tae)      # Structure
myData = melt.data.frame(
data = subset(tae, select = c(Class, Size)),
id.vars = "Class"
)
ggplot(myData, aes(factor(variable), value)) +
xlab("") + ylab("") + geom_boxplot() + coord_flip() +
facet_wrap( ~ Class, ncol=1, scales="free")
ggplot(myData, aes(factor(variable), value)) +
xlab("") + ylab("") + geom_boxplot() + coord_flip() +
facet_wrap( ~ Class, ncol=1)
ggplot(myData, aes(factor(variable), value)) +
xlab("") + ylab("") + geom_freqpoly() + coord_flip() +
facet_wrap( ~ Class, ncol=1)
ggplot(myData, aes(factor(variable), value)) +
xlab("") + ylab("") + geom_freqpoly() + coord_flip() +
facet_wrap( ~ Class, ncol=1)
ggplot(myData, aes(value)) +
xlab("") + ylab("") + geom_freqpoly() + coord_flip() +
facet_wrap( ~ Class, ncol=1)
ggplot(tae, aes(x = Course, y = Instructor, color = Class)) +
ggplot(myData, aes(factor(variable), value)) +
xlab("") + ylab("") + geom_boxplot() + coord_flip() +
facet_wrap( ~ Class, ncol=1)
ggplot(myData, aes(factor(variable), value)) +
xlab("") + ylab("") + geom_boxplot() + coord_flip() +
facet_wrap( ~ Class, ncol=1)
ggplot(myData, aes(value, colour = Class)) +
geom_freqpoly(bins = 29) +
facet_wrap( ~ variable, ncol = 2, scales="free")
ggplot(myData, aes(value, colour = Class)) +
geom_freqpoly(bins = 10) +
facet_wrap( ~ variable, ncol = 2, scales="free")
ggplot(myData, aes(value, colour = Class)) +
geom_freqpoly(bins = 7) +
facet_wrap( ~ variable, ncol = 2, scales="free")
ggplot(myData, aes(value, colour = Class)) +
geom_freqpoly(bins = 7)
ggplot(myData, aes(value, colour = Class)) +
geom_freqpoly(bins = 7) + xlab("Size")
ggplot(myData, aes(value, colour = Class)) +
geom_freqpoly(bins = 5) + xlab("Size")
ggplot(myData, aes(value, colour = Class)) +
geom_density(bins = 5) + xlab("Size")
ggplot(myData, aes(value, colour = Class)) +
geom_freqpoly(bins = 7) + xlab("Size")
# Barplots of factors
myData = melt.data.frame(
data = subset(tae, select = -Size),
id.vars = "Class"
)
ggplot(myData, aes(value, color = Class)) +
geom_bar(stat = "count")
ggplot(myData, aes(value, fill = Class)) +
geom_bar(stat = "count")
ggplot(myData, aes(value, fill = Class)) +
geom_bar(stat = "count") + coord_flip()
ggplot(myData, aes(value, fill = Class)) +
geom_bar(stat = "density") + coord_flip()
ggplot(myData, aes(value, fill = Class)) +
geom_bar() + coord_flip()
ggplot(myData, aes(value, fill = Class)) +
geom_bar(stat = "density") + coord_flip()
ggplot(myData, aes(value, fill = Class)) +
geom_bar(stat = "count") + coord_flip()
ggplot(abalone, aes(x = Sex, fill = Sex)) +
geom_bar(stat = "count") + facet_wrap(~ variable)
ggplot(abalone, aes(x = Sex, fill = Sex)) +
geom_bar(stat = "count") + facet_wrap(~ variable, ncol = 1)
ggplot(myData, aes(value, fill = Class)) +
geom_bar(stat = "count") + coord_flip() + facet_wrap(~ variable, ncol = 1)
?geom_bar
ggplot(myData, aes(value, fill = Class)) +
geom_bar(stat = "count") + coord_flip() + facet_wrap(~ variable, ncol = 1, scales = "free")
myData = melt.data.frame(
data = subset(tae, select = c(-Size, -Instructor, -Course)),
id.vars = "Class"
)
ggplot(myData, aes(value, fill = Class)) +
geom_bar(stat = "count") + coord_flip() + facet_wrap(~ variable, ncol = 1, scales = "free")
ggplot(myData, aes(value, fill = Class)) +
geom_bar(stat = "count") + facet_wrap(~ variable, ncol = 1, scales = "free")
myData = melt.data.frame(
data = subset(tae, select = c(-Size, -Native, -Semester)),
id.vars = "Class"
)
ggplot(myData, aes(value, fill = Class)) +
geom_bar(stat = "count") + facet_wrap(~ variable, ncol = 1, scales = "free")
ggplot(myData, aes(value, fill = Class)) +
geom_bar(stat = "density") + facet_wrap(~ variable, ncol = 1, scales = "free")
?geom_bar
ggplot(myData, aes(value, fill = Class)) +
geom_bar(stat = "prop") + facet_wrap(~ variable, ncol = 1, scales = "free")
ggplot(myData, aes(value, fill = Class)) +
geom_bar(stat = "ndensity") + facet_wrap(~ variable, ncol = 1, scales = "free")
ggplot(myData, aes(value, fill = Class)) +
geom_bar(stat = "density") + facet_wrap(~ variable, ncol = 1, scales = "free")
ggplot(myData, aes(value, fill = Class)) +
geom_bar(stat = "density", width = 2) + facet_wrap(~ variable, ncol = 1, scales = "free")
ggplot(myData, aes(value, fill = Class)) +
geom_bar(stat = "density", width = 1) + facet_wrap(~ variable, ncol = 1, scales = "free")
ggplot(myData, aes(value, fill = Class)) +
geom_bar(stat = "density", width = 0.1) + facet_wrap(~ variable, ncol = 1, scales = "free")
ggplot(myData, aes(value, fill = Class)) +
geom_bar(stat = "density", width = 0.2) + facet_wrap(~ variable, ncol = 1, scales = "free")
geom_bar(stat = "count", width = 1) + facet_wrap(~ variable, ncol = 1, scales = "free")
# Data is heterogeneous
ggplot(myData, aes(value, fill = Class)) +
geom_bar(stat = "count", width = 1) + facet_wrap(~ variable, ncol = 1, scales = "free")
ggplot(myData, aes(value, fill = Class)) +
geom_bar(stat = "count", width = 0.9) + facet_wrap(~ variable, ncol = 1, scales = "free")
ggplot(myData, aes(value, fill = Class)) +
geom_dodge(stat = "count", width = 0.9) + facet_wrap(~ variable, ncol = 1, scales = "free")
install.packages("ggplot2")
install.packages("ggplot2")
install.packages("ggplot2")
install.packages("ggplot2")
source("../classification/build-workspace.R")
library("ggplot2", lib.loc="~/R/x86_64-pc-linux-gnu-library/3.3")
detach("package:ggplot2", unload=TRUE)
